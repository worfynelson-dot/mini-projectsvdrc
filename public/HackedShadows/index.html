<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,user-scalable=no">
<title>Hacked Shadows 2.0 - Ultimate Horror Desktop</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}html{height:100vh;overflow:hidden;}body{font-family:'Segoe UI',Tahoma,sans-serif;background:#000;color:#fff;height:100vh;position:relative;overflow:hidden;cursor:none;}
#canvas-overlay{width:100vw;height:100vh;position:fixed;top:0;left:0;pointer-events:none;z-index:1;}
#desktop{position:relative;z-index:2;width:100vw;height:100vh;background:linear-gradient(135deg,#0a0a0a 0%,#1a0000 50%,#000 100%);background-size:400% 400%;animation:hauntBg 20s ease infinite;}
@keyframes hauntBg{0%{background-position:0% 50%;}50%{background-position:100% 50%;filter:hue-rotate(180deg) brightness(0.5);}100%{background-position:0% 50%;}}
#wallpaper{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0.3;background:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9ImJsb29kIiBjeD0iNTAlIiBjeT0iNTAlIiByPSIxMDAlIj48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjZmYwMDAwIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjMjAwMDAwIi8+PC9yYWRpYWxHcmFkaWVudD48L2RlZnM+PGNpcmNsZSBjeD0iMjAwIiBjeT0iMjAwIiByPSIyMDAiIGZpbGw9InVybCgjYmxvb2QpIiBvcGFjaXR5PSIwLjIiLz48L3N2Zz4=') repeat;animation:bloodDrip 10s linear infinite;}
@keyframes bloodDrip{0%{transform:translateY(0);}100%{transform:translateY(100vh);}}
#taskbar{position:fixed;bottom:0;left:0;right:0;height:48px;background:linear-gradient(to top,hsla(0,0%,0%,0.9),hsla(0,0%,10%,0.95));backdrop-filter:blur(20px);display:flex;align-items:center;padding:0 16px;z-index:100;box-shadow:0 -4px 20px rgba(255,0,0,0.3);}
#start{width:48px;height:36px;background:linear-gradient(145deg,#00ff41,#00cc33);border-radius:8px 0 0 8px;box-shadow:0 2px 10px rgba(0,255,65,0.4);margin-right:8px;position:relative;overflow:hidden;}
#start::before{content:'';position:absolute;top:4px;left:4px;right:4px;height:2px;background:#000;}
#clock{margin-left:auto;font-size:14px;font-weight:500;color:#ccc;text-shadow:0 0 10px #f00;}
.taskbtn{position:relative;width:32px;height:32px;background:#333;border-radius:6px;margin-left:4px;display:flex;align-items:center;justify-content:center;font-size:16px;transition:0.2s;box-shadow:0 2px 8px rgba(0,0,0,0.5);}
.taskbtn:hover{background:#444;box-shadow:0 0 15px #0f0;}
.taskbtn.active{background:#f00;box-shadow:0 0 20px #f00;}
.window{position:absolute;min-width:420px;max-width:90vw;max-height:85vh;border-radius:12px;background:linear-gradient(145deg,#1e1e1e,#111);border:1px solid #444;box-shadow:0 8px 32px rgba(0,0,0,0.8),inset 0 1px 0 rgba(255,255,255,0.1);overflow:hidden;display:none;z-index:10;animation:winOpen 0.3s ease;}
@keyframes winOpen{from{opacity:0;transform:scale(0.95) translateY(20px);}to{opacity:1;transform:scale(1) translateY(0);}}
#titlebar{height:40px;background:linear-gradient(to right,#2a2a2a,#1a1a1a);display:flex;align-items:center;padding:0 12px;font-size:13px;font-weight:500;color:#eee;border-bottom:1px solid #555;cursor:move;position:relative;}
.close{position:absolute;right:12px;top:12px;width:24px;height:24px;border-radius:50%;background:#e81123;color:#fff;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:bold;transition:0.2s;}
.close:hover{background:#f1707a;transform:scale(1.1);}
#content{padding:20px;height:calc(100% - 42px);overflow:auto;color:#ddd;font-size:14px;line-height:1.6;}
.puzzle-btn{background:linear-gradient(145deg,#0f5,#0a4);border:none;border-radius:8px;padding:12px 20px;color:#fff;font-weight:500;cursor:pointer;transition:0.2s;box-shadow:0 4px 12px rgba(0,255,0,0.3);}
.puzzle-btn:hover{background:linear-gradient(145deg,#0a6,#085);box-shadow:0 0 20px #0f5;transform:translateY(-2px);}
#pointer{width:24px;height:24px;background:conic-gradient(from 0deg,#fff,#0ff,#f0f,#fff);border-radius:50%;box-shadow:0 0 20px #0ff,0 0 40px #f00;transition:all 0.1s;mix-blend-mode:difference;}
.icon{position:absolute;width:90px;height:90px;background:linear-gradient(145deg,#2d2d2d,#1f1f1f);border-radius:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:48px;transition:all 0.3s ease;box-shadow:0 8px 24px rgba(0,0,0,0.6),0 0 0 1px rgba(255,255,255,0.1);}
.icon span{font-size:12px;font-weight:500;margin-top:6px;color:#bbb;}
.icon:hover{transform:translateY(-8px) scale(1.05);box-shadow:0 20px 40px rgba(255,0,0,0.4),0 0 40px #f00;background:linear-gradient(145deg,#3d1a1a,#2a0f0f);}
.icon.active{animation:pulse 1s infinite;box-shadow:0 0 50px #f00 !important;}
@keyframes pulse{0%,100%{box-shadow:0 0 50px #f00;}50%{box-shadow:0 0 70px #f00,0 0 100px #f00;}}
#icons>*{margin:30px;}
#horror-meter{position:fixed;top:20px;right:20px;width:200px;height:20px;background:#222;border-radius:10px;overflow:hidden;z-index:100;box-shadow:0 0 20px rgba(255,0,0,0.5);}
#horror-fill{width:0%;height:100%;background:linear-gradient(to right,#f00,#ff0);transition:width 0.5s;box-shadow:0 0 20px #f00;}
#horror-text{position:absolute;top:25px;right:20px;font-size:12px;color:#f00;text-shadow:0 0 10px #f00;}
#inventory{position:fixed;bottom:70px;left:20px;width:300px;height:120px;background:rgba(0,0,0,0.9);border-radius:12px;padding:16px;display:none;z-index:101;border:1px solid #444;}
.inv-item{background:#333;border-radius:8px;padding:8px;margin:4px 0;cursor:pointer;}
.eyes{position:absolute;width:40px;height:40px;background:#fff;border-radius:50%;pointer-events:none;z-index:5;mix-blend-mode:difference;box-shadow:0 0 20px #fff;}
.eyes::after{content:'';position:absolute;top:10px;left:10px;width:20px;height:20px;background:#000;border-radius:50%;transition:0.1s;}
#loading{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:28px;text-align:center;color:#0ff;text-shadow:0 0 30px #0ff;z-index:1000;}
@media (max-width:768px){#taskbar{height:56px;padding:0 12px;}#start{width:56px;height:42px;}.icon{width:70px;height:70px;font-size:36px;}.icon span{font-size:10px;}.window{min-width:320px;}.taskbtn{width:36px;height:36px;font-size:20px;}}
</style>
</head>
<body>
<canvas id="canvas-overlay"></canvas>
<div id="desktop">
  <div id="wallpaper"></div>
  <div id="icons">
    <div class="icon" data-app="files"><div>üìÅ</div><span>Files</span></div>
    <div class="icon" data-app="terminal"><div>‚ö°</div><span>CMD</span></div>
    <div class="icon" data-app="phone"><div>üì±</div><span>Hack</span></div>
    <div class="icon" data-app="browser"><div>üåê</div><span>DarkWeb</span></div>
    <div class="icon" data-app="email"><div>‚úâÔ∏è</div><span>Email</span></div>
    <div class="icon" data-app="camera"><div>üì∑</div><span>Cam</span></div>
  </div>
</div>
<div id="taskbar">
  <div id="start"></div>
  <div id="clock"></div>
  <div id="horror-meter"><div id="horror-fill"></div></div>
  <div id="horror-text">Horror: 0/10</div>
</div>
<div id="inventory">
  <h3>Inventory</h3>
  <div id="inv-list"></div>
</div>
<div id="loading">Hacked Shadows 2.0<br>Loading Nightmares... <div style="width:0%;height:4px;background:#f00;margin:10px 0;animation:loadbar 3s linear;"></div></div>
<script>
// Ultimate Fixed Horror Game v2.0 - Beautiful Win11 UI, Multitask, Puzzles, Mobile Perfect, Super Horror!
let gameState={scene:0,time:0,maxTime:1800,inventory:[],clues:{},codes:{files:'1337',email:'DEAD',camera:'GHOST'},hacked:false,escaped:false,ended:false,horrorLevel:0};
let windows=[],nextZ=11,eyes=[],particles=[],audioCtx;
const canvas=document.getElementById('canvas-overlay'),ctx=canvas.getContext('2d'),desktop=document.getElementById('desktop'),taskbar=document.getElementById('taskbar'),pointer=document.getElementById('pointer'),icons=document.querySelectorAll('.icon'),horrorMeter=document.getElementById('horror-fill'),horrorText=document.getElementById('horror-text'),invList=document.getElementById('inv-list'),inventory=document.getElementById('inventory'),loading=document.getElementById('loading');
let mouseX=0,mouseY=0,isDragging=false,dragWin=null,dragOffset={x:0,y:0},currentFocus='';
initGame();
function initGame(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;initAudio();setInterval(gameLoop,16);setInterval(updateClock,1000);setTimeout(hideLoading,4000);icons.forEach(icon=>icon.onclick=()=>openWindow(icon.dataset.app));startBtn.onclick=toggleStart;updateEyes();spawnParticles();localStorage.gameState&&Object.assign(gameState,JSON.parse(localStorage.gameState));saveState();}
function initAudio(){audioCtx=new(window.AudioContext||window.webkitAudioContext)();}document.onclick=()=>audioCtx?.resume();
function playSound(type,freq=440,dur=1,vol=0.3){if(!audioCtx)return;let o=audioCtx.createOscillator(),g=audioCtx.createGain();o.type=type||'sine';o.frequency.value=freq;g.gain.setValueAtTime(vol, audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+dur);o.connect(g);g.connect(audioCtx.destination);o.start();o.stop(audioCtx.currentTime+dur);}
function playCreep(){playSound('sawtooth',Math.random()*200+50,4,0.1);}function playScream(){playSound('sawtooth',800,0.8,0.6);setTimeout(()=>playSound('square',400,2,0.4),400);}function playWhisper(){playSound('sine',200,3,0.05);}
function handleInput(e){e.preventDefault();updateMouse(e);let el=document.elementFromPoint(mouseX,mouseY);if(el?.classList.contains('icon'))return openWindow(el.dataset.app);if(el?.classList.contains('close'))closeWindow(el.closest('.window'));if(el?.classList.contains('taskbtn'))focusWindow(el.dataset.id);if(el?.classList.contains('puzzle-btn'))eval(el.onclick.toString().match(/function\s*\w*\s*\(([^)]*)\)\s*\{([^}]*)\}/)?.pop()?.split(';')[0]||'');horrorJump();}
document.addEventListener('mousemove',handleInput);document.addEventListener('touchmove',handleInput,{passive:false});document.addEventListener('mousedown',handleInput);document.addEventListener('touchstart',handleInput,{passive:false});
function updateMouse(e){if(e.touches?.[0]){mouseX=e.touches[0].clientX;mouseY=e.touches[0].clientY;}else{mouseX=e.clientX;mouseY=e.clientY;}pointer.style.left=mouseX+'px';pointer.style.top=mouseY+'px';updateEyes();}
function openWindow(app){let win=createWindow(app);windows.push({id:win.id,app,z:nextZ++});win.style.zIndex=win.z;taskbar.insertBefore(createTaskBtn(win.id,app),horrorMeter);focusWindow(win.id);updateContent(win,app);}
function createWindow(app){let win=document.createElement('div');win.className='window';win.id='win'+Date.now();win.innerHTML=`<div id="titlebar"><span>${app.toUpperCase()}</span><div class="close">√ó</div></div><div id="content"></div>`;win.style.left=(50+Math.random()*200)+'px';win.style.top=(50+Math.random()*100)+'px';win.style.display='block';desktop.appendChild(win);win.querySelector('#titlebar').onmousedown=e=>startDrag(win,e);win.querySelector('.close').onclick=()=>closeWindow(win);return win;}
function createTaskBtn(id,app){let btn=document.createElement('div');btn.className='taskbtn active';btn.dataset.id=id;btn.textContent=app[0].toUpperCase();btn.onclick=()=>focusWindow(id);return btn;}
function closeWindow(win){if(typeof win==='string')win=document.getElementById(win);let idx=windows.findIndex(w=>w.id===win.id);if(idx>-1){let task=document.querySelector(`[data-id="${win.id}"]`);task?.remove();windows.splice(idx,1);win.remove();}}
function focusWindow(id){windows.forEach(w=>{document.getElementById(w.id).style.zIndex=w.z;document.querySelector(`[data-id="${w.id}"]`).classList.toggle('active',w.id===id);});document.querySelector(`[data-id="${id}"]`).classList.add('active');currentFocus=id;}
function startDrag(win,e){dragWin=win;isDragging=true;dragOffset={x:e.clientX-parseFloat(win.style.left),y:e.clientY-parseFloat(win.style.top)};}document.onmousemove=e=>{if(isDragging){dragWin.style.left=e.clientX-dragOffset.x+'px';dragWin.style.top=e.clientY-dragOffset.y+'px';}};document.onmouseup=()=>isDragging=false;
function updateContent(win,app){let cont=win.querySelector('#content');if(app==='files'){cont.innerHTML=`<p><b>Puzzle 1:</b> Decipher log for code.</p><p>"Shadows hide 1337 secrets..."</p><input id="code1" placeholder="Enter code" style="width:100%;padding:10px;margin:10px 0;background:#222;border:1px solid #444;color:#0f0;"><button class="puzzle-btn" onclick="solveFiles()">Submit</button>`;}
else if(app==='terminal'){cont.innerHTML=`<div id="term" style="background:#000;padding:20px;height:400px;overflow:auto;font-family:monospace;color:#0f0;">$ gh0st_cmd> <span id="termcur">_</span></div><div style="margin-top:10px;">Type: help, ls, cat log.txt, hack_phone [code]</div>`;termFocus(win);}
else if(app==='phone'){cont.innerHTML=`<p><b>Puzzle 2:</b> Scrapy Hack (use code from Files)</p><input id="hackcode" placeholder="1337"><button class="puzzle-btn" onclick="scrapyHack()">Run Scrapy</button><div id="hackout"></div>`;}
else if(app==='browser'){cont.innerHTML=`<p>DarkWeb: Clues only if hacked.</p>${gameState.hacked?'<p>GPS: 666 Dead St. Input in Email.</p>':''}`;}
else if(app==='email'){cont.innerHTML=`<p>Email from Victim:</p><p>"Code: DEAD. Reply to escape."</p><input id="emailcode" placeholder="DEAD"><button class="puzzle-btn" onclick="solveEmail()">Send</button>`;}
else if(app==='camera'){cont.innerHTML=`<p>Cam Puzzle: Spot ghost (click spots).</p><div style="position:relative;width:300px;height:200px;background:#333;margin:10px 0;"><div class="spot" style="position:absolute;top:20%;left:20%;width:20px;height:20px;background:#f00;border-radius:50%;cursor:pointer;" onclick="solveCam()"></div></div>`;}}
window.solveFiles=()=>{let code=document.getElementById('code1').value;if(code==='1337'){gameState.clues.files=true;addInv('Code 1337');horrorEvent();}else horrorJump();};
window.scrapyHack=()=>{let code=document.getElementById('hackcode').value;if(code==='1337'&&gameState.clues.files){gameState.hacked=true;document.getElementById('hackout').innerHTML='<p style="color:#0f0;">Scrapy SUCCESS: GPS 666 Dead St!</p>';addInv('GPS Data');gameState.scene=2;}else{horrorJump();}};
window.solveEmail=()=>{let code=document.getElementById('emailcode').value;if(code==='DEAD'&&gameState.hacked){gameState.clues.email=true;addInv('Email Reply');}else horrorJump();};
window.solveCam=()=>{gameState.clues.camera=true;addInv('Ghost Photo');if(Object.values(gameState.clues).every(v=>v))escapeGame();};
function termFocus(win){/* Mobile KB sim integrated in global */} // Simplified, use global input for term
function addInv(item){gameState.inventory.push(item);updateInv();inventory.style.display='block';}
function updateInv(){invList.innerHTML=gameState.inventory.map(i=>`<div class="inv-item">${i}</div>`).join('');}
function toggleStart(){/* Enhanced menu with save/load */ localStorage.clear();alert('Reset - All puzzles lost!');}
function horrorEvent(){gameState.horrorLevel=Math.min(10,gameState.horrorLevel+1);horrorMeter.style.width=gameState.horrorLevel*10+'%';horrorText.textContent=`Horror: ${gameState.horrorLevel}/10`;playScream();spawnParticles(20);}
function horrorJump(){if(Math.random()<0.3)playScream();if(Math.random()<gameState.horrorLevel*0.01)spawnGhost();}
function spawnGhost(){let g=document.createElement('div');g.innerHTML='üëª';g.style.cssText='position:absolute;font-size:60px;color:#f00;pointer-events:none;z-index:50;left:'+(Math.random()*100)+'vw;top:'+(Math.random()*50)+'vh;animation:ghostFloat 4s forwards';g.style.animation='ghostFloat 4s forwards';desktop.appendChild(g);setTimeout(()=>g.remove(),4000);}
function updateEyes(){eyes.forEach((eye,i)=>{let dx=mouseX-eye.x,dy=mouseY-eye.y;let dist=Math.sqrt(dx*dx+dy*dy);eye.style.left=(eye.x+(dx/dist)*5)+'px';eye.style.top=(eye.y+(dy/dist)*5)+'px';});}
function spawnParticles(n=5){for(let i=0;i<n;i++){particles.push({x:Math.random()*canvas.width,y:canvas.height+50,vx:Math.random()*4-2,vy:-Math.random()*10-5,r:Math.random()*3+1,color:'rgba(255,0,0,'+(0.5+Math.random()*0.5)+')'});}}
function gameLoop(){ctx.clearRect(0,0,canvas.width,canvas.height);particles.forEach((p,i)=>{p.x+=p.vx;p.y+=p.vy;p.vy+=0.1;if(p.y>canvas.height){particles.splice(i,1);}else{ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fillStyle=p.color;ctx.fill();}});}
function updateClock(){gameState.time++;if(gameState.time%300===0&&!gameState.escaped)horrorEvent();saveState();}
function saveState(){localStorage.gameState=JSON.stringify(gameState);}
function escapeGame(){gameState.escaped=true;alert('ESCAPED! But... Refresh for New Nightmare.');}
function hideLoading(){loading.style.opacity='0';setTimeout(()=>loading.remove(),1000);}
setInterval(()=>{if(gameState.horrorLevel>3&&Math.random()<0.02)spawnEyes();},5000);
function spawnEyes(){let eye=document.createElement('div');eye.className='eyes';eye.style.left=(Math.random()*100)+'vw';eye.style.top=(Math.random()*100)+'vh';desktop.appendChild(eye);eyes.push(eye);setTimeout(()=>eyes.splice(eyes.indexOf(eye),1)&&eye.remove(),10000);}
</script>
</body>
</html>
